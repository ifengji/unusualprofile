<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to unusualprofile package • unusualprofile</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Introduction to unusualprofile package">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">unusualprofile</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/my-vignette.html">Introduction to unusualprofile package</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Introduction to unusualprofile package</h1>
                        <h4 class="author">Feng Ji</h4>
            
            <h4 class="date">2018-10-11</h4>
      
      
      <div class="hidden name"><code>my-vignette.Rmd</code></div>

    </div>

    
    
<div id="motivation" class="section level1">
<h1 class="hasAnchor">
<a href="#motivation" class="anchor"></a>Motivation</h1>
<p>This package automates the process of making sense of psychoeducational test batteries results for practitioners/school psychologists, using latent-variable-based methods <span class="citation">(Ji, 2018)</span>.</p>
</div>
<div id="estimating-factor-scores" class="section level1">
<h1 class="hasAnchor">
<a href="#estimating-factor-scores" class="anchor"></a>Estimating factor scores</h1>
<p>Factor scores are calculated using Thurstone’s method <span class="citation">(Schneider, 2013; Thurstone, 1935)</span>:</p>
<p><span class="math display">\[\hat{a}_{i}= R_{XX}\Lambda R_{YY}^{-1}y_{i}=R_{XY}R_{YY}^{-1}y_{i}\]</span></p>
<p>Where</p>
<p><span class="math inline">\(\hat{a}_{i}\)</span> is a random vector of the ith subject’s factor scores estimate on the common factors.<br><span class="math inline">\(R_{XX}\)</span> is the correlation matrix among the latent factors. <span class="math inline">\(\Lambda\)</span> is the factor-pattern matrix.<br><span class="math inline">\(R_{XY}\)</span> is a correlation matrix between the common factors and the observed variables.<br><span class="math inline">\(R_{YY}^{-1}\)</span> is the inverse of the correlation matrix among the observed variables.<br><span class="math inline">\(y_{i}\)</span> is a random vector of the ith subject’s standardized scores on the observed variables.</p>
</div>
<div id="predicting-individuals-unusualness-in-population" class="section level1">
<h1 class="hasAnchor">
<a href="#predicting-individuals-unusualness-in-population" class="anchor"></a>Predicting individual’s unusualness in population</h1>
<p><span class="math display">\[d_{cM}=\sqrt{(Z_{o}-\hat{Z}_{o})'R_o^{-1}(Z_{o}-\hat{Z}_{o})}\]</span> <span class="math inline">\(\hat{Z}_{o}\)</span> is the vector of predicted outcome scores (i.e., the predicted academic abilities predicted by the factor scores of cognitive abilities).<br><span class="math inline">\(Z_{o}\)</span> is the vector of outcome scores (i.e., the factor scores of academic abilities estimated from our SEM).<br><span class="math inline">\(R_o^{-1}\)</span> is the matrix of conditional variance among the factor scores (the composite correlation between factor scores calculated using population correlation among observed scores, that is, <span class="math inline">\(\beta'\Sigma_{xx}\beta\)</span>, where <span class="math inline">\(\beta=\Sigma_{yx}\Sigma_{xx}^{-1}\)</span>. If multivariate normality can be assumed and there are c outcome scores,<br><span class="math display">\[d_{cM}^{2} \sim\chi^{2}(k)\]</span></p>
</div>
<div id="a-worked-example" class="section level1">
<h1 class="hasAnchor">
<a href="#a-worked-example" class="anchor"></a>A worked example</h1>
<p><img src="reading_tutorial.svg" width="100%" height="100%"></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw">library</span>(magrittr)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="kw">library</span>(unusualprofile)</a>
<a class="sourceLine" id="cb1-4" data-line-number="4"></a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="co"># Make data</span></a>
<a class="sourceLine" id="cb1-6" data-line-number="6">m =<span class="st"> "Gc =~ 0.9 * Gc_1 + 0.9 * Gc_2 + 0.9 * Gc_3"</span></a>
<a class="sourceLine" id="cb1-7" data-line-number="7">d_data &lt;-<span class="st"> </span><span class="kw"><a href="../reference/simStandardized.html">simStandardized</a></span>(<span class="dt">m =</span> m,</a>
<a class="sourceLine" id="cb1-8" data-line-number="8">                          <span class="dt">n =</span> <span class="dv">10000</span>)</a>
<a class="sourceLine" id="cb1-9" data-line-number="9"></a>
<a class="sourceLine" id="cb1-10" data-line-number="10"><span class="co"># Make case 1 and 2</span></a>
<a class="sourceLine" id="cb1-11" data-line-number="11">d_case &lt;-<span class="st"> </span><span class="kw">matrix</span>(</a>
<a class="sourceLine" id="cb1-12" data-line-number="12">  <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb1-13" data-line-number="13">    <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>), </a>
<a class="sourceLine" id="cb1-14" data-line-number="14">  <span class="dv">2</span>, <span class="dt">byrow =</span> T) <span class="op">%*%</span></a>
<a class="sourceLine" id="cb1-15" data-line-number="15"><span class="st">  </span><span class="kw">cbind</span>(<span class="kw">diag</span>(<span class="dv">3</span>), d_data<span class="op">$</span>FactorScoreCoef[, <span class="st">"Gc"</span>]) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1-16" data-line-number="16"><span class="st">  </span><span class="kw">set_colnames</span>(<span class="kw">c</span>(<span class="kw">paste0</span>(<span class="st">"Gc_"</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>), <span class="st">"Gc_FS"</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1-17" data-line-number="17"><span class="st">  </span><span class="kw">as_tibble</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1-18" data-line-number="18"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Gc =</span> Gc_FS <span class="op">/</span><span class="st"> </span>d_data<span class="op">$</span>FactorScoreValidity[<span class="st">"Gc"</span>])</a>
<a class="sourceLine" id="cb1-19" data-line-number="19"></a>
<a class="sourceLine" id="cb1-20" data-line-number="20"><span class="co"># Calculate d_CM</span></a>
<a class="sourceLine" id="cb1-21" data-line-number="21">d_CM &lt;-<span class="st"> </span><span class="kw"><a href="../reference/CMahalanobis.html">CMahalanobis</a></span>(</a>
<a class="sourceLine" id="cb1-22" data-line-number="22">  <span class="dt">d =</span> d_case,</a>
<a class="sourceLine" id="cb1-23" data-line-number="23">  <span class="dt">R =</span> d_data<span class="op">$</span>R_all,</a>
<a class="sourceLine" id="cb1-24" data-line-number="24">  <span class="dt">Dep =</span> <span class="kw">paste0</span>(<span class="st">"Gc_"</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>),</a>
<a class="sourceLine" id="cb1-25" data-line-number="25">  <span class="dt">Ind =</span> <span class="st">"Gc"</span>,</a>
<a class="sourceLine" id="cb1-26" data-line-number="26">  <span class="dt">UseFactorScores_Ind =</span> T</a>
<a class="sourceLine" id="cb1-27" data-line-number="27">)</a>
<a class="sourceLine" id="cb1-28" data-line-number="28">d_M &lt;-</a>
<a class="sourceLine" id="cb1-29" data-line-number="29"><span class="st">  </span><span class="kw"><a href="../reference/CMahalanobis.html">CMahalanobis</a></span>(</a>
<a class="sourceLine" id="cb1-30" data-line-number="30">    <span class="dt">Dep =</span> <span class="kw">paste0</span>(<span class="st">"Gc_"</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>),</a>
<a class="sourceLine" id="cb1-31" data-line-number="31">    <span class="dt">R =</span> d_data<span class="op">$</span>R_all,</a>
<a class="sourceLine" id="cb1-32" data-line-number="32">    <span class="dt">d =</span> d_case <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="op">-</span>Gc)</a>
<a class="sourceLine" id="cb1-33" data-line-number="33">  )</a>
<a class="sourceLine" id="cb1-34" data-line-number="34"></a>
<a class="sourceLine" id="cb1-35" data-line-number="35"><span class="co"># Make Table 3</span></a>
<a class="sourceLine" id="cb1-36" data-line-number="36">d_case <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1-37" data-line-number="37"><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>Gc) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1-38" data-line-number="38"><span class="st">  </span><span class="kw">mutate_all</span>(<span class="cf">function</span>(x)</a>
<a class="sourceLine" id="cb1-39" data-line-number="39">    x <span class="op">*</span><span class="st"> </span><span class="dv">15</span> <span class="op">+</span><span class="st"> </span><span class="dv">100</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1-40" data-line-number="40"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">pdM =</span> <span class="kw">as.vector</span>(d_M<span class="op">$</span>p),</a>
<a class="sourceLine" id="cb1-41" data-line-number="41">         <span class="dt">pdCM =</span> <span class="kw">as.vector</span>(d_CM<span class="op">$</span>p),</a>
<a class="sourceLine" id="cb1-42" data-line-number="42">         <span class="dt">Case =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1-43" data-line-number="43"><span class="st">  </span><span class="kw">select</span>(Case, <span class="kw">everything</span>()) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1-44" data-line-number="44"><span class="st">  </span>magrittr<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/magrittr/topics/aliases">set_colnames</a></span>(</a>
<a class="sourceLine" id="cb1-45" data-line-number="45">    <span class="kw">c</span>(</a>
<a class="sourceLine" id="cb1-46" data-line-number="46">      <span class="st">"$</span><span class="ch">\\</span><span class="st">text{Case}$"</span>,</a>
<a class="sourceLine" id="cb1-47" data-line-number="47">      <span class="st">"$Gc_1$"</span>,</a>
<a class="sourceLine" id="cb1-48" data-line-number="48">      <span class="st">"$Gc_2$"</span>,</a>
<a class="sourceLine" id="cb1-49" data-line-number="49">      <span class="st">"$Gc_3$"</span>,</a>
<a class="sourceLine" id="cb1-50" data-line-number="50">      <span class="st">"$</span><span class="ch">\\</span><span class="st">hat{G}c$"</span>,</a>
<a class="sourceLine" id="cb1-51" data-line-number="51">      <span class="st">"$</span><span class="ch">\\</span><span class="st">text{P}(d_M)$"</span>,</a>
<a class="sourceLine" id="cb1-52" data-line-number="52">      <span class="st">"$</span><span class="ch">\\</span><span class="st">text{P}(d_{CM})$"</span></a>
<a class="sourceLine" id="cb1-53" data-line-number="53">    )</a>
<a class="sourceLine" id="cb1-54" data-line-number="54">  ) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1-55" data-line-number="55"><span class="st">  </span>knitr<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/knitr/topics/kable">kable</a></span>(<span class="dt">digits =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">3</span>), <span class="dt">align =</span> <span class="st">"lcccccc"</span>)</a></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left"><span class="math inline">\(\text{Case}\)</span></th>
<th align="center"><span class="math inline">\(Gc_1\)</span></th>
<th align="center"><span class="math inline">\(Gc_2\)</span></th>
<th align="center"><span class="math inline">\(Gc_3\)</span></th>
<th align="center"><span class="math inline">\(\hat{G}c\)</span></th>
<th align="center"><span class="math inline">\(\text{P}(d_M)\)</span></th>
<th align="center"><span class="math inline">\(\text{P}(d_{CM})\)</span></th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="center">130</td>
<td align="center">130</td>
<td align="center">130</td>
<td align="center">130.9</td>
<td align="center">0.795</td>
<td align="center">0.046</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="center">115</td>
<td align="center">130</td>
<td align="center">145</td>
<td align="center">130.9</td>
<td align="center">0.998</td>
<td align="center">0.987</td>
</tr>
</tbody>
</table>
<p>We can use the proposed method to make sense of observed scores. If the observed scores of the three tests measuring Gc are all 130, we can calculate the (unconditional) Mahalanobis distance to show that the profile of the three scores would be less usual than about 80% of the population (see Table). If the observed scores of the three tests measuring Gc are 115, 130 and 145, the profile would be less usual than 99.8% of population. We can see from this case that although they have equal averages, their unusualness is quite different. The problem with the traditional Mahalanobis distance is that both profiles are unusual because the scores, on average, are 2 standard deviations above the mean. With the proposed conditional Mahalanobis distance (conditioned on the estimated factor score of 130.9), we would see in Table 3 that Case 2, with a variable profile, is still more unusual than 98.5% of profiles with the same factor score. Case 1—with equal scores conditioned on an equally weighted factor score—is the least unusual profile possible. Thus, with the conditional Mahalanobis distance, one can distinguish between profiles that are unusual because of elevation and those that are unusual because of variability in their shape.</p>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div id="refs" class="references">
<div id="ref-ji2018">
<p>Ji, F. (2018). Applying conditional distributions to individuals: Using latent variable models. Illinois State University.</p>
</div>
<div id="ref-schneider2013if">
<p>Schneider, W. J. (2013). What if we took our models seriously? Estimating latent scores in individuals. <em>Journal of Psychoeducational Assessment</em>, <em>31</em>(2), 186–201.</p>
</div>
<div id="ref-thurstone1935vectors">
<p>Thurstone, L. L. (1935). <em>The vectors of mind: Multiple-factor analysis for the isolation of primary traits.</em> Chicago, IL: University of Chicago Press.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#motivation">Motivation</a></li>
      <li><a href="#estimating-factor-scores">Estimating factor scores</a></li>
      <li><a href="#predicting-individuals-unusualness-in-population">Predicting individual’s unusualness in population</a></li>
      <li><a href="#a-worked-example">A worked example</a></li>
      <li><a href="#references">References</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Feng Ji, W. Joel Schneider.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
